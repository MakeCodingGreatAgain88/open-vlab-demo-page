# OpenVLab Market Demo Page

这是一个基于 React + TypeScript + Ant Design 开发的 OpenVLab 市场页面复现项目，用于技术面试展示。

## 🎯 项目特点

- ✅ **完整的页面布局**：Header 导航、搜索标签、热门板块、数据表格
- ✅ **多页面路由**：市场概览页面和市场详情页面
- ✅ **高级图表功能**：使用 lightweight-charts 实现交互式行情图表
- ✅ **响应式设计**：完美适配桌面端和移动端
- ✅ **性能优化**：使用 React.memo 优化组件渲染，使用 useMemo 和 useCallback 优化计算
- ✅ **丰富的交互功能**：表格排序、标签筛选、图表切换
- ✅ **自定义图表组件**：SVG 仪表盘、滑块图表、折线预览图表
- ✅ **主题定制**：深色主题，欧易交易所颜色风格主题配置
- ✅ **类型安全**：完整的 TypeScript 类型定义
- ✅ **组件化架构**：清晰的组件结构，易于维护和扩展

## 🛠️ 技术栈

- **React 18.2.0** - UI 框架
- **TypeScript 4.9.5** - 类型支持
- **Ant Design 5.28.0** - UI 组件库
- **lightweight-charts 5.0.9** - 专业图表库
- **React Router 7.9.5** - 路由管理
- **Tailwind CSS 4.1.16** - 工具类 CSS 框架
- **Vite 5.0.8** - 构建工具
- **React Hooks** - 状态管理
- **Auto Import** - 自动导入 React Hooks，提升开发效率

## 📦 环境要求

- Node.js >= 14.0.0
- npm >= 6.0.0

## 📦 安装

```bash
# 克隆项目
git clone <repository-url>

# 进入项目目录
cd open-vlab-demo-page

# 安装依赖
npm install
```

## 🚀 启动

```bash
# 开发模式启动
npm run dev

# 或者
npm start
```

项目将在 `http://localhost:5173` 启动（Vite 默认端口）。

## 📱 功能说明

### 1. 路由结构

- `/` - 自动重定向到 `/market`
- `/market` - 市场概览页面
- `/market/:code` - 市场详情页面

### 2. 市场概览页面 (`/market`)

#### Header 导航
- 左侧：Logo + 顶部导航菜单（市场、行情、波动率、异动、策略、交易、教学、社区）
- 右侧：用户操作菜单（等待列表、联系我们、邀请好友、myProfile）
- 移动端：显示汉堡菜单

#### 搜索标签
- 支持单选标签进行数据筛选
- 标签包括：全部、股指、金属、能化、农副、油脂、黑色、各交易所等
- 点击标签后会刷新下方热门板块和表格数据

#### 热门板块
- **隐波最大上升**：展示隐波变化最大的前 5 条数据
- **隐波最大下降**：展示隐波变化最小的前 5 条数据
- **波动率溢价最高**：展示溢价最高的前 5 条数据
- **波动率溢价最低**：展示溢价最低的前 5 条数据
- 每个板块包含：名称、标的涨幅%、隐波变化、分时预览图表
- 点击行可跳转到详情页面

#### 数据表格
- **排序功能**：支持所有列的升序/降序排序，点击列标题即可排序
- **列说明**：每列标题带有 Tooltip 说明（hover 查看），帮助用户理解数据含义
- **固定列**：名称列固定在左侧，方便横向滚动时查看
- **图表预览**：走势预览列使用自定义 SVG 图表展示实时走势
- **可视化展示**：
  - 偏度百分位：使用仪表盘图形（半圆 SVG）展示
  - 隐波比分位：使用滑块图形（横向渐变）展示
- **颜色标识**：
  - 涨幅显示：红色 rgb(239, 83, 80)
  - 跌幅显示：绿色 rgb(8, 153, 129)
- **分页功能**：支持分页显示，可自定义每页条数
- **行点击跳转**：点击行可跳转到对应的详情页面
- **数据列**：
  - 名称（固定列，带图标和品类代码）
  - 最新价
  - 标的涨幅
  - 剩余时间
  - 当月隐波
  - 隐波变化
  - 隐波涨速
  - 实波
  - 溢价
  - 当月偏度
  - 隐波比分位（滑块图形）
  - 偏度百分位（仪表盘图形）
  - 走势预览（SVG 图表）

### 3. 市场详情页面 (`/market/:code`)

#### Head 区域
展示产品关键信息：
- **现价**：当前最新价格
- **涨幅百分比**：价格变化百分比（带颜色标识）
- **实波**：实际波动率
- **隐波**：隐含波动率
- **偏度**：使用仪表盘图形展示偏度百分位

#### Content 区域

**图表切换**
- 支持三种图表类型切换：
  - **分时**：折线图，展示 4 小时内的价格走势
  - **5日**：折线图，展示 5 天内的价格走势，并标注最高点和最低点
  - **日线**：K 线图（蜡烛图），展示日线级别的价格变化

**图表功能**
- 使用 lightweight-charts 专业图表库
- 支持图表缩放和平移
- 鼠标悬停显示详细数据工具提示：
  - 价格、涨幅比、开、高、低、收
  - 隐波、成交量、持仓量
- 5日线图表特殊功能：
  - 自动标注最高点和最低点（箭头标记）
  - 显示最高点和最低点的横向虚线
- 移动端优化：
  - 隐藏网格线，简化界面
  - 隐藏时间刻度（移动端）
  - 价格刻度宽度自适应
  - 图表高度响应式调整

## 📂 项目结构

```
src/
├── components/          # 组件目录
│   ├── Header/         # 头部导航组件
│   ├── SearchTags/     # 搜索标签组件
│   ├── HotSections/    # 热门板块组件
│   │   ├── HotSectionsDesktop.tsx  # 桌面端展示
│   │   └── HotSectionsMobile.tsx   # 移动端展示
│   ├── DataTable/      # 数据表格组件
│   ├── MiniChart/      # 迷你图表组件（SVG）
│   ├── GaugeChart/     # 仪表盘组件（SVG）
│   ├── PercentileSlider/  # 滑块图表组件（SVG）
│   ├── PriceChange/    # 价格变化显示组件
│   └── ErrorBoundary/  # 错误边界组件
├── pages/              # 页面目录
│   ├── Market/         # 市场概览页面
│   └── MarketDetails/  # 市场详情页面
│       ├── ChartView.tsx  # 图表组件
│       └── MarketDetails.css
├── hooks/              # 自定义 Hooks
│   ├── useMarketData.ts      # 市场数据管理 Hook
│   └── useMarketDetails.ts   # 市场详情数据管理 Hook
├── utils/              # 工具函数
│   ├── mockData.ts          # 模拟数据生成
│   └── marketDetailsData.ts # 市场详情数据生成
├── types/              # TypeScript 类型定义
│   └── index.ts
├── config/             # 配置文件
│   └── theme.ts        # Ant Design 主题配置
├── assets/             # 静态资源
│   └── icon/           # 图标文件
├── App.tsx             # 主应用组件
├── App.css             # 应用样式
├── index.tsx           # 入口文件
└── index.css           # 全局样式
```

## 🎨 主题配置

项目使用了欧易交易所的颜色风格：
- **主色**：#1B53E5（欧易蓝）
- **涨幅色**：rgb(239, 83, 80)（红色）
- **跌幅色**：rgb(8, 153, 129)（绿色）
- **背景色**：#000000（黑色）
- **边框色**：#1A1A1A（深灰色）

## 🚀 构建

```bash
# 生产环境构建
npm run build
```

构建后的文件位于 `dist/` 目录。

## 📦 打包优化策略

项目已配置完整的打包优化策略，以提升构建性能和加载速度：

### 1. 代码压缩与优化
- **压缩工具**：使用 `esbuild` 进行代码压缩，比 `terser` 速度更快
- **CSS 压缩**：启用 CSS 压缩，减小样式文件体积
- **移除调试代码**：生产环境自动移除 `console` 和 `debugger` 语句
- **移除注释**：移除法律注释，减小文件体积

### 2. 代码分割（Code Splitting）
项目采用手动代码分割策略，将第三方库分离为独立的 chunk：

- **react-vendor**：包含 React、React DOM、React Router
- **antd-vendor**：包含 Ant Design 组件库和相关图标
- **charts-vendor**：包含 lightweight-charts 图表库

**优势**：
- 提升缓存利用率：第三方库更新频率低，可以长期缓存
- 并行加载：多个 chunk 可以并行下载
- 按需加载：减少首屏加载时间

### 3. CSS 代码分割
- **启用 CSS 代码分割**：每个页面/组件独立生成 CSS 文件
- **按需加载**：只加载当前页面所需的样式
- **减小首屏体积**：提升页面加载速度

### 4. 文件组织优化
构建后的文件按类型分类存放，便于管理和缓存：

```
dist/
├── js/           # JavaScript 文件
├── css/          # CSS 文件
├── images/       # 图片资源
├── fonts/        # 字体文件
├── media/        # 媒体文件（视频、音频）
└── assets/       # 其他资源
```

### 5. 资源优化
- **资源内联阈值**：小于 4KB 的资源自动内联为 base64，减少 HTTP 请求
- **文件 Hash**：所有文件使用 hash 命名，确保更新时浏览器正确刷新缓存
- **文件分类**：不同类型资源分类存放，便于 CDN 缓存策略配置

### 6. 构建配置优化
- **禁用 Sourcemap**：生产环境不生成 sourcemap，减小构建体积和构建时间
- **目标浏览器**：`es2015`，平衡兼容性和代码体积
- **压缩报告**：启用压缩大小报告，便于监控构建产物
- **Chunk 大小警告**：超过 1000KB 时发出警告，提醒优化

### 7. 性能指标
- **构建速度**：使用 esbuild 压缩，构建速度提升约 10-100 倍
- **包体积**：通过代码分割，首屏加载体积减少约 30-50%
- **缓存效率**：vendor chunks 可长期缓存，提升二次访问速度

### 优化效果预期
- ✅ 首屏加载时间减少 30-50%
- ✅ 构建时间显著提升（esbuild vs terser）
- ✅ 缓存命中率提升，减少重复下载
- ✅ 代码体积减小，移除调试代码和注释

## 👀 预览

```bash
# 预览构建后的项目
npm run preview
```

## 🎨 核心功能实现说明

根据考核要求，本项目实现了以下核心功能：

### 1. 行情表格筛选
- ✅ 通过标签进行板块筛选（全部、股指、金属、能化等）
- ✅ 筛选后实时更新热门板块和表格数据
- ✅ 数据固定化：筛选后数据保持不变，便于验证排序准确性

### 2. 行情表格排序
- ✅ 所有列均支持排序功能
- ✅ 支持升序/降序切换
- ✅ 排序状态管理优化，解决多次点击同一列失效的问题
- ✅ 排序后数据固定，不会因重新生成而变化

### 3. 图表功能
- ✅ 使用 lightweight-charts 实现专业级图表展示
- ✅ 支持三种图表类型：分时（折线）、5日（折线）、日线（K线）
- ✅ 图表数据模拟真实波动性
- ✅ 5日线自动标注最高点和最低点
- ✅ 自定义工具提示显示详细数据

### 4. 移动端适配（加分项）
- ✅ 完整的移动端响应式布局
- ✅ 移动端专属的热门板块组件
- ✅ 图表移动端优化（隐藏网格线、调整价格刻度等）
- ✅ 触摸友好的交互体验

### 5. 组件化架构
- ✅ 清晰的组件结构
- ✅ 可复用的自定义组件（仪表盘、滑块、迷你图表等）
- ✅ 错误边界保护，提升应用稳定性

## 📝 注意事项

- 项目使用模拟数据，实际项目中需要替换为真实 API
- 图表数据为随机生成，实际使用需要从后端获取
- 响应式布局已优化，可在不同设备上正常访问
- 项目使用 Auto Import 插件自动导入 React Hooks，无需手动 import
- 数据缓存机制确保筛选和排序时的数据一致性

## 🔧 开发规范

- ✅ **组件化**：所有功能模块都封装为独立组件
- ✅ **性能优化**：组件使用 `React.memo` 进行性能优化
- ✅ **类型安全**：完整的 TypeScript 类型定义
- ✅ **代码规范**：统一的代码风格和命名规范
- ✅ **错误处理**：关键操作都有错误处理机制
- ✅ **路由管理**：使用 React Router 进行页面路由管理

## 📊 项目亮点

1. **完整的用户体验**：从筛选到排序，从概览到详情，提供完整的数据交互功能
2. **专业级图表**：使用 lightweight-charts 实现高质量的交互式图表
3. **性能优化**：使用 React.memo、useMemo、useCallback 等优化渲染性能
4. **移动端适配**：不仅支持桌面端，还完美适配移动端
5. **类型安全**：完整的 TypeScript 支持，减少运行时错误
6. **代码质量**：清晰的组件结构，易于维护和扩展
7. **可视化组件**：自定义 SVG 组件展示数据，提升用户体验

## 📄 License

MIT

---

**注意**：本项目为技术面试展示项目，使用了模拟数据。在实际生产环境中，需要接入真实的 API 数据。
